<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <title>GiftWise.</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link rel="stylesheet" href="assets/css/main.css?v=3.4">
    <script src="./js/app.js"></script>
    
</head>

<body>
    <!-- Quick view -->
    <header class="header-area header-style-5">
        <div class="header-bottom sticky-bar sticky-white-bg" id="headertop">
        </div>
    </header>

    <main class="main">   
        <div class="footer-bottom"></div>
        <section class="product-tabs section-padding position-relative wow fadeIn animated">
            <div class="container">
                <div class="tab-header section-padding mt-15 mb-25">
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="nav-tab-three" data-bs-toggle="tab" data-bs-target="#tab-three" type="button" role="tab" aria-controls="tab-three" aria-selected="true">All Products</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="nav-tab-one" data-bs-toggle="tab" data-bs-target="#tab-one" type="button" role="tab" aria-controls="tab-one" aria-selected="false">Shop by Category</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="nav-tab-two" data-bs-toggle="tab" data-bs-target="#tab-two" type="button" role="tab" aria-controls="tab-two" aria-selected="false">Shop by Brands</button>
                    </li>
                    </ul>
                </div>
                <div class="tab-content wow fadeIn animated" id="myTabContent">
                    <div class="tab-pane fade show" id="tab-one" role="tabpanel" aria-labelledby="tab-one">
                        <!-- <section class="popular-categories section-padding mt-15 mb-25"> -->
                            <div class="container wow fadeIn animated">
                                <!-- <h3 class="section-title mb-20">Categories</h3> -->
                                <div class="row product-grid-4" id = "CategoryList">
                                </div>
                            </div>
                        <!-- </section> -->
                    </div>
                    <div class="tab-pane fade show" id="tab-two" role="tabpanel" aria-labelledby="tab-two">
                        <!-- <section class="popular-categories section-padding mt-15 mb-25"> -->
                            <div class="container wow fadeIn animated">
                                <!-- <h3 class="section-title mb-20">Brands</h3> -->
                                <div class="row product-grid-4" id = "BrandsList">
                                </div>
                            </div>
                        <!-- </section> -->
                    </div>
                    <div class="tab-pane fade show active" id="tab-three" role="tabpanel" aria-labelledby="tab-three">
                        <!-- <section class="popular-categories section-padding mt-15 mb-25"> -->
                            <div class="container wow fadeIn animated">
                                <!-- <h3 class="section-title mb-20">Products</h3> -->
                                <div class="row product-grid-4" id = "ProductsList">
                                </div>
                            </div>
                        <!-- </section> -->
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer class="main" id="footer"></footer>
    <!-- Preloader Start -->
    <div id="preloader-active">
        <div class="preloader d-flex align-items-center justify-content-center">
            <div class="preloader-inner position-relative">
                <div class="text-center">
                    <h5 class="mb-10">Now Loading</h5>
                    <div class="loader">
                        <div class="bar bar1"></div>
                        <div class="bar bar2"></div>
                        <div class="bar bar3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Vendor JS-->
    <script src="assets/js/vendor/modernizr-3.6.0.min.js"></script>
    <script src="assets/js/vendor/jquery-3.6.0.min.js"></script>
    <script src="assets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
    <script src="assets/js/vendor/bootstrap.bundle.min.js"></script>
    <script src="assets/js/plugins/slick.js"></script>
    <script src="assets/js/plugins/jquery.syotimer.min.js"></script>
    <script src="assets/js/plugins/wow.js"></script>
    <script src="assets/js/plugins/jquery-ui.js"></script>
    <script src="assets/js/plugins/perfect-scrollbar.js"></script>
    <script src="assets/js/plugins/magnific-popup.js"></script>
    <script src="assets/js/plugins/select2.min.js"></script>
    <script src="assets/js/plugins/waypoints.js"></script>
    <script src="assets/js/plugins/counterup.js"></script>
    <script src="assets/js/plugins/jquery.countdown.min.js"></script>
    <script src="assets/js/plugins/images-loaded.js"></script>
    <script src="assets/js/plugins/isotope.js"></script>
    <script src="assets/js/plugins/scrollup.js"></script>
    <script src="assets/js/plugins/jquery.vticker-min.js"></script>
    <script src="assets/js/plugins/jquery.theia.sticky.js"></script>
    <script src="assets/js/plugins/jquery.elevatezoom.js"></script>
    <!-- Template  JS -->
    <script src="./assets/js/main.js?v=3.4"></script>
    <script src="./assets/js/shop.js?v=3.4"></script>
    <script src="./js/footer.js"></script>
    <script src="./js/header.js"></script>
    <script>
        var accessToken = localStorage.getItem('accessToken');

        function redirectProduct(idProduct) {
            window.location.href = `product.html?idProduct=${idProduct}`;
        }
        function redirectCategory(idCategory) {
            window.location.href = `category.html?id=${idCategory}`;
        }
        function redirectBrand(idBrand) {
            window.location.href = `brand.html?id=${idBrand}`;
        }

        async function getAllCategories() {
            return new Promise((resolve, reject) => {
                console.log("inside getcat");
                $.ajax({
                    type: 'GET',
                    url: categoryAPI,
                    headers: {
                        'Authorization': 'Bearer ' + accessToken
                    },
                    contentType: 'application/json',
                    success: function (response) {
                        console.log("res",response);
                        if (response.status !== 200) {
                            console.log(response)
                        } else {
                            resolve(response)
                        }
                    },
                    error: function (error) {
                        reject(reject)
                    }
                });
            })
        }
        async function getAllBrands() {
            return new Promise((resolve, reject) => {
                console.log("inside getbrand");
                $.ajax({
                    type: 'GET',
                    url: brandAPI,
                    headers: {
                        'Authorization': 'Bearer ' + accessToken
                    },
                    contentType: 'application/json',
                    success: function (response) {
                        console.log("res",response);
                        if (response.status !== 200) {
                            console.log(response)
                        } else {
                            resolve(response)
                        }
                    },
                    error: function (error) {
                        reject(reject)
                    }
                });
            })
        }
        async function getAllProducts() {
            return new Promise((resolve, reject) => {
                console.log("inside getproduct");
                $.ajax({
                    type: 'GET',
                    url: productAPI,
                    headers: {
                        'Authorization': 'Bearer ' + accessToken
                    },
                    contentType: 'application/json',
                    success: function (response) {
                        console.log("res",response);
                        if (response.status !== 200) {
                            console.log(response)
                        } else {
                            resolve(response)
                        }
                    },
                    error: function (error) {
                        reject(reject)
                    }
                });
            })
        }
        async function processData() {
            const CategoryResponse = await getAllCategories();

            $('#CategoryList').empty();
            CategoryResponse.payload.forEach(element => {
                console.log("element : ",element);
                $('#CategoryList').append(`  
                <div class="col-lg-3 col-md-4 col-8 col-sm-4">              
                <div class="card-1" onClick="redirectCategory(${element.idCategory})">
                    <figure class=" img-hover-scale overflow-hidden">
                        <a><img src="assets/imgs/shop/category-thumb-1.jpg" alt=""></a>
                    </figure>
                    <h5><a>${element.categoryName}</a></h5>
                </div></div>`)
            });

            const BrandsResponse = await getAllBrands();

            $('#BrandsList').empty();
            BrandsResponse.payload.forEach(element => {
                console.log("element : ",element);
                $('#BrandsList').append(`  
                <div class="col-lg-3 col-md-4 col-8 col-sm-4">              
                <div class="card-1" onClick="redirectBrand(${element.idBrand})">
                    <figure class=" img-hover-scale overflow-hidden">
                        <a><img src="assets/imgs/shop/category-thumb-1.jpg" alt=""></a>
                    </figure>
                    <h5><a>${element.brandName}</a></h5>
                </div></div>`)
            });

            const ProductResponse = await getAllProducts();

            $('#ProductsList').empty();
            ProductResponse.payload.forEach(element => {
                console.log("element : ",element);
                let Valstock = "In Stock";
                if (element.quantity > 0){
                    Valstock = "In Stock";
                }
        
                $('#ProductsList').append(`  
                <div class="col-lg-3 col-md-4 col-8 col-sm-4">              
                <div class="card-1" onClick="redirectProduct(${element.idProduct})">
                    <figure class=" img-hover-scale overflow-hidden">
                    <a style="display: block; height: 200px; overflow: hidden;">
                        <img src="${element.imageURL}" alt="" style="width: 100%; height: auto; object-fit: contain;">
                    </a>                
                    </figure>
                    <h5><a >${element.productName}</a></h5>
                    <h5><a >Price : $${element.amount}</a></h5>
                    <h5><a >${Valstock}</a></h5>
                </div></div>`)
            });
        }

        processData();
    </script>
   
</body>

</html>